<section class="crud-card estudiante-card">
  <div class="crud-card__header">
    <div class="crud-card__title">
      <span aria-hidden="true" class="crud-card__icon">🎓</span>
      <div>
        <h2>Estudiantes</h2>
        <p>Registra estudiantes y asignalos a un colegio.</p>
      </div>
    </div>
    <div class="crud-card__actions">
      <button type="button" class="btn btn-primary" (click)="loadEstudiantes()" [disabled]="loading()">
        Consultar
      </button>
    </div>
  </div>

  <div class="crud-card__body">
    <form class="crud-form crud-form--inline" [formGroup]="createForm" (ngSubmit)="createEstudiante()">
      <div class="crud-field">
        <label class="visually-hidden" for="estudiante-create-nombre">Nombre del estudiante</label>
        <input
          id="estudiante-create-nombre"
          type="text"
          formControlName="nombre"
          placeholder="Nombre del estudiante"
        />
      </div>
      <div class="crud-field">
        <label class="visually-hidden" for="estudiante-create-colegio">Código de colegio</label>
        <input
          id="estudiante-create-colegio"
          type="number"
          formControlName="colegioId"
          placeholder="Código del colegio"
        />
      </div>
      <button type="submit" class="btn btn-primary" [disabled]="createForm.invalid || loading()">
        Guardar Estudiante
      </button>
    </form>

    <div class="utility-forms">
      <form class="crud-form crud-form--inline" [formGroup]="updateForm" (ngSubmit)="updateEstudiante()">
        <div class="crud-field">
          <label class="visually-hidden" for="estudiante-update-id">Código del estudiante</label>
          <input id="estudiante-update-id" type="number" formControlName="id" placeholder="Código del estudiante" />
        </div>
        <div class="crud-field">
          <label class="visually-hidden" for="estudiante-update-nombre">Nombre</label>
          <input id="estudiante-update-nombre" type="text" formControlName="nombre" placeholder="Nuevo nombre" />
        </div>
        <div class="crud-field">
          <label class="visually-hidden" for="estudiante-update-colegio">Código de colegio</label>
          <input
            id="estudiante-update-colegio"
            type="number"
            formControlName="colegioId"
            placeholder="Código del colegio"
          />
        </div>
        <button type="submit" class="btn btn-flat" [disabled]="updateForm.invalid || loading()">
          Actualizar
        </button>
      </form>

      <form class="crud-form crud-form--inline" [formGroup]="deleteForm" (ngSubmit)="deleteEstudiante()">
        <div class="crud-field">
          <label class="visually-hidden" for="estudiante-delete-id">Código para eliminar</label>
          <input id="estudiante-delete-id" type="number" formControlName="id" placeholder="Código para eliminar" />
        </div>
        <button type="submit" class="btn btn-flat" [disabled]="deleteForm.invalid || loading()">
          Eliminar
        </button>
      </form>
    </div>
  </div>

  <div class="table-wrapper" *ngIf="estudiantes().length > 0; else emptyEstudiante">
    <table class="data-table">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Colegio</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let estudiante of estudiantes()">
          <td>{{ estudiante.nombre }}</td>
          <td>{{ estudiante.colegioNombre || 'Sin asignar' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <ng-template #emptyEstudiante>
    <div class="empty-state">Usa consultar para ver los estudiantes registrados.</div>
  </ng-template>

  @if (lastMessage()) {
    <p class="status-message">{{ lastMessage() }}</p>
  }
</section>
